<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Redactor</title>

    <!--<link rel="stylesheet" href="styles/reset.css"/>-->
    <link rel="stylesheet" href="styles/styles.css"/>
    <link rel="stylesheet" href="styles/tomorrow-night-bright.css">
    <link rel="stylesheet" href="styles/redactor.css">
    <link rel="stylesheet" href="styles/taggd.css" />

</head>
<body>

    <div class="header cf">
        <a href="#" class="subject">Knowledge</a>
        <div class="header-wrap">
            <div class="row">
                <div class="xlarge4">
                    <div class="btn btn-product">product</div>
                </div>
                <div class="xlarge4 x_offset8">
                    <form action="" class="search">
                        <div class="search-wrap"> ÑŒ
9                            <input class="search-submit" type="submit"/>
                            <input class="search-text" type="text" placeholder="Search..." />
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <a href="#" class="user"><img src="http://placecreature.com/40/40" alt=""/></a>
    </div>

    <div class="wrap">
        <div class="row main">
            <div class="xlarge4">
                <ul class="nav">
                    <li class="nav-list active">
                        <a class="nav-item" href="#">Theme number 1</a>
                        <ul class="sub-nav">
                            <li class="nav-list"><a href="#" class="nav-item">Sub theme 1</a></li>
                            <li class="nav-list active"><a href="#" class="nav-item">Sub theme 2</a></li>
                            <li class="nav-list"><a href="#" class="nav-item">Sub theme 3</a></li>
                            <li class="nav-list"><a href="#" class="nav-item">Sub theme 4</a></li>
                        </ul>
                    </li>
                    <li class="nav-list"><a class="nav-item" href="#">Theme number 2</a></li>
                    <li class="nav-list">
                        <a class="nav-item" href="#">Theme number 3</a>
                        <ul class="sub-nav">
                            <li class="nav-list"><a href="#" class="nav-item">Sub theme 1</a></li>
                            <li class="nav-list"><a href="#" class="nav-item">Sub theme 2</a></li>
                            <li class="nav-list"><a href="#" class="nav-item">Sub theme 3</a></li>
                        </ul>
                    </li>
                    <li class="nav-list"><a class="nav-item" href="#">Theme number 4</a></li>
                </ul>
            </div>
            <div class="xlarge12">
                <div class="view">

                    <div class="section-wrap">

                        <div class="section">

                            <div class="sub-section" id="redactor">
                                <h1>Theme number 1</h1>
                            </div>
                            <span class="btn-edit"></span>

                            <div class="btn-plus-wrap">
                                <a href="javascript:void(0)" class="btn btn-plus">Add</a>
                            </div>

                        </div>

                        <div class="section">

                            <div class="sub-section">
                                <p>
                                    Less runs inside Node, in the browser and inside Rhino. There are also many 3rd party tools that allow you to compile your files and watch for changes.
                                    Less runs inside Node, in the browser and inside Rhino. There are also many 3rd party tools that allow you to compile your files and watch for changes.
                                    Less runs inside Node, in the browser and inside Rhino. There are also many 3rd party tools that allow you to compile your files and watch for changes.
                                    Less runs inside Node, in the browser and inside Rhino. There are also many 3rd party tools that allow you to compile your files and watch for changes.
                                    Less runs inside Node, in the browser and inside Rhino. There are also many 3rd party tools that allow you to compile your files and watch for changes.
                                    Less runs inside Node, in the browser and inside Rhino. There are also many 3rd party tools that allow you to compile your files and watch for changes.
                                    Less runs inside Node, in the browser and inside Rhino. There are also many 3rd party tools that allow you to compile your files and watch for changes.
                                    Less runs inside Node, in the browser and inside Rhino. There are also many 3rd party tools that allow you to compile your files and watch for changes.
                                </p>
                            </div>
                            <span class="btn-edit"></span>

                            <div class="btn-plus-wrap">
                                <a href="javascript:void(0)" class="btn btn-plus">Add</a>
                            </div>
                        </div>

                    </div>

                    <div class="section-wrap">

                        <div class="section">

                            <div class="btn-plus-wrap">
                                <a href="javascript:void(0)" class="btn btn-plus">Add</a>
                            </div>

                        </div>

                    </div>

                </div>
            </div>
        </div>
    </div>

    <div class="footer">
        <div class="footer-wrap">
            <p class="footer-text">Last update by Alex</p>
            <p class="footer-text">lorem ipsum sit amet lorem ipsum sit amet lorem ipsum sit amet lorem ipsum sit amet lorem ipsum sit amet</p>
        </div>
    </div>

    <div class="overlay"></div>
    <div class="popup">
        <span class="close"></span>
        <div class="popup-title">Products</div>
        <div class="product-list">
            <a href="javascript:void(0)" class="product-item">
                <img src="http://placecreature.com/100/40" alt=""/>
                <span class="product-name">Product 1</span>
                <span class="product-data">12.12.12</span>
            </a>
        </div>
    </div>

    <script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
    <script src="js/highlight.pack.js"></script>
    <script src="js/redactor.js"></script>
    <script src="js/jquery.taggd.min.js"></script>
    <script src="js/jquery.selection.js"></script>

<!--for me))-->
<script>

    $(function() {
        $(window).scroll(function() {

            var top = $(window).scrollTop();

            if ( top > 0 ) {
                $('.header').addClass('shadow');
            } else {
                $('.header').removeClass('shadow');
            }

            $('.nav').css({ "margin-top" : top + "px" });
        });

        $('.section').mouseenter(function() {
            $(this).find('span.btn-edit').addClass('visible');
        });
        $('.section').mouseleave(function() {
            $(this).find('span.btn-edit').removeClass('visible');
        });

        $('.btn-product').click(function() {
            $('body').addClass('noScroll');
            $('.overlay').addClass('visible');
        });
        $('.overlay').click(function() {
            $('body').removeClass('noScroll');
            $('.overlay').removeClass('visible');
        })
    });

    $.Redactor.prototype.highlight = function()
    {
        return {
            save: function()
            {
                var html = this.code.get();
                console.log(html);
            },
            init: function()
            {
                var button = this.button.add('bold', 'Insert Code');
                this.button.addCallback(button, this.highlight.code);
            },
            code: function()
            {
                this.inline.format('pre', 'class', 'code');
            }
        };
    };
    var obj = null,
        lastElement = null;
    $(document).ready(function() {
        $('.btn-edit').on('click', function(){
            loadRedactor($(this).prev());
            lastElement = $(this).prev();
        });
        var options = {
            align: {
                y: 'top'
            },

            offset: {
                top: 15
            },

            handlers: {
                click: 'toggle'
            }
        };

        var data = [
            { x: 0.62, y: 0.7, text: 'Rope'             },
            { x: 0.51, y: 0.5, text: 'Bird'             },
            { x: 0.40, y: 0.3, text: 'Water, obviously' }
        ];
    });
    function loadRedactor(element)
    {
        var positionCaret = 0;

        element.redactor({
            iframe: true,
            cleanStyleOnEnter: false,
            plugins: ["highlight"],
            initCallback: function()
            {
                this.selection.restore();
                element.off('click', loadRedactor);

                if(lastElement != null) {
                    console.log(lastElement.redactor('core'))
                    lastElement.redactor('core.destroy');
                }

                $('#btn-save').show();
            },
            blurCallback: function()
            {
                element.redactor('core.destroy');
            },
            destroyCallback: function(e)
            {
                lastElement = null;
                setTimeout(function() {
                    element.find("pre.code").each(function () {
                        hljs.highlightBlock(this);
                    });
                },1);
            }
        });
    }

    function saveRedactor()
    {
        // save content if you need
        var html = $('#redactor').redactor('code.get');

        // destroy editor
        $('#redactor').redactor('core.destroy');
        $('#btn-save').hide();
    }
    function escapeHtml(unsafe) {
        return unsafe
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
    }
</script>
<!--end-->
</body>
</html>